<div class="ai-chat-dialog" [@slideIn]>
  <!-- Header -->
  <div class="chat-header">
    <div class="header-content">
             <div class="ai-avatar">
         <mat-icon class="ai-icon">psychology</mat-icon>
       </div>
             <div class="header-info">
         <h2 class="ai-title">Craze</h2>
         <p class="ai-subtitle">TaskFlow Manager Support</p>
       </div>
      <button class="close-btn" (click)="closeDialog()">
        <mat-icon>close</mat-icon>
      </button>
    </div>
  </div>

  <!-- Chat Messages -->
  <div class="chat-messages" #chatContainer>
    <div class="messages-container">
      <div 
        *ngFor="let message of messages" 
        class="message-wrapper"
        [ngClass]="{'user-message': message.sender === 'user', 'ai-message': message.sender === 'ai'}"
        [@messageSlide]>
        
        <div class="message" [ngClass]="{'user': message.sender === 'user', 'ai': message.sender === 'ai'}">
                     <div class="message-avatar" *ngIf="message.sender === 'ai'">
             <mat-icon class="avatar-icon">psychology</mat-icon>
           </div>
          
          <div class="message-content">
            <div class="message-text">{{ message.text }}</div>
            <div class="message-time">{{ getTimeString(message.timestamp) }}</div>
          </div>
          
          <div class="message-avatar user-avatar" *ngIf="message.sender === 'user'">
            <mat-icon class="avatar-icon">person</mat-icon>
          </div>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="message-wrapper ai-message" *ngIf="isTyping" [@typingIndicator]="'typing'">
        <div class="message ai">
                     <div class="message-avatar">
             <mat-icon class="avatar-icon">psychology</mat-icon>
           </div>
          <div class="message-content">
            <div class="typing-indicator">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Input Area -->
  <div class="chat-input">
    <div class="input-container">
      <mat-form-field class="message-input" appearance="outline">
        <mat-label>Type your message...</mat-label>
        <textarea 
          matInput 
          id="ai-chat-message"
          [(ngModel)]="newMessage" 
          (keypress)="onKeyPress($event)"
          placeholder="Hey! What's on your mind? Ask me anything about TaskFlow Manager..."
          rows="1"
          maxlength="500">
        </textarea>
        <mat-hint align="end">{{ newMessage.length }}/500</mat-hint>
      </mat-form-field>
      
      <button 
        class="send-btn" 
        (click)="sendMessage()" 
        [disabled]="!newMessage.trim() || isTyping">
        <mat-icon>send</mat-icon>
      </button>
    </div>
    
    <!-- Quick Actions -->
    <div class="quick-actions">
      <span class="quick-label">Quick questions:</span>
      <button class="quick-btn" (click)="addMessage('user', 'How do I create a task?'); sendMessage()">
        Create Task
      </button>
      <button class="quick-btn" (click)="addMessage('user', 'How do I use the dashboard?'); sendMessage()">
        Dashboard
      </button>
      <button class="quick-btn" (click)="addMessage('user', 'How do I use board view?'); sendMessage()">
        Board View
      </button>
      <button class="quick-btn" (click)="addMessage('user', 'How do I check notifications?'); sendMessage()">
        Notifications
      </button>
    </div>
  </div>
</div>
